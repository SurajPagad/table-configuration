<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ui_page">
    <sys_ui_page action="INSERT_OR_UPDATE">
        <category>general</category>
        <client_script><![CDATA[var sampleApps = angular.module('sn_sampleApps', []);
sampleApps.controller('mainCtrl', function($scope) {
    $scope.artifacts = [];
    $scope.loading = false;
    $j("#app_id_hidden").change(function() {
        $scope.loading = true;
        var appID = gel('app_id_hidden').value;
        if (appID) {
            var ga = new GlideAjax('GetAppArtifacts');
            ga.addParam('sysparm_name', 'getAppArtifacts');
            ga.addParam('sysparm_app_id', appID);
            ga.getXML(callBack);
        }

        function callBack(response) {
            var answer = response.responseXML.documentElement.getAttribute("answer");
            var parsedAnswer = JSON.parse(answer);
            $scope.artifacts = parsedAnswer.artifacts;
            $scope.loading = false;
            $scope.$apply();
        }
        $scope.$apply();
    });

    $scope.removeSpecialChars = function(name) {
        return name.replaceAll(/[\s|&]/g, '');
    };

    $scope.toggleIcon = function(event) {
        $j(event.target).find('i.rotate').toggleClass('icon-chevron-right icon-chevron-down');
    };

    $scope.getlink = function(artifactItem) {
        return '/sys_metadata.do?sys_id=' + artifactItem.sysId;
    };

    $scope.hasArtifacts = function(types) {
        return types.some(function(type) {
            return type.artifacts && type.artifacts.length > 0 ? true : false;
        });
    };

});

function setHiddenInput() {
    $j('#app_id_hidden').val(gel('app').value).trigger('change');
}]]></client_script>
        <description/>
        <direct>false</direct>
        <endpoint/>
        <html><![CDATA[<?xml version="1.0" encoding="utf-8" ?>
<j:jelly trim="false" xmlns:j="jelly:core" xmlns:g="glide" xmlns:j2="null" xmlns:g2="null">
    <g2:requires name="scripts/angular_includes_1.4.js" includes="true" />
    <div data-doctype="true" ng-app="sn_sampleApps">
        <div ng-controller="mainCtrl">
            <p>Select an application to fetch the artifacts</p>
            <g:ui_reference name="app" id="app_id" table="sys_scope" query="active=true" ng-model="app_id_model"
                completer="AJAXTableCompleter" onchange="setHiddenInput()" columns="scope" />
            <input type="HIDDEN" name="app_id_hidden" ng-model='app_id_hidden' id="app_id_hidden"
                ng-change="getArtifacts()" />
            <div id='response'>
                <div ng-if="loading">
                    Loading...
                </div>
                <ul ng-if="artifacts.length > 0 &amp;&amp; !loading">
                    <li ng-repeat="artifact in artifacts">
                        <span ng-if="hasArtifacts(artifact.types)">
                            <span data-toggle="collapse" data-target="{{'#'+removeSpecialChars(artifact.name)}}" ng-click="toggleIcon($event)" class="list-label"><i
                                    class="icon-chevron-down rotate"></i>{{ artifact.name }}</span>
                            <span ng-if="artifact.types &amp;&amp; artifact.types.length > 0">
                                <ul class="collapse in collapsible-list" id="{{removeSpecialChars(artifact.name)}}">
                                    <li ng-repeat="type in artifact.types">
                                        <span ng-if="type.artifacts &amp;&amp; type.artifacts.length > 0">
                                            <span data-toggle="collapse"
                                                data-target="{{'#'+removeSpecialChars(type.name)}}" ng-click="toggleIcon($event)" class="list-label"><i
                                                    class="icon-chevron-down rotate"></i>{{ type.name }}</span>
                                            <span ng-if="type.artifacts.length > 0">
                                                <ul class="collapse in collapsible-list" id="{{removeSpecialChars(type.name)}}">
                                                    <li ng-repeat="artifactItem in type.artifacts">
                                                        <a href='{{getlink(artifactItem)}}'
                                                            target='_blank'>{{artifactItem.name}}</a>
                                                    </li>
                                                </ul>
                                            </span>
                                        </span>
                                    </li>
                                </ul>
                            </span>
                        </span>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <style>
        ul {
            list-style: none
        }

        i {
            margin-right: 5px
        }
    </style>
</j:jelly>]]></html>
        <name>application_explorer_new</name>
        <processing_script/>
        <sys_class_name>sys_ui_page</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2022-08-09 16:09:42</sys_created_on>
        <sys_id>388fd4902f191110916d50492799b6d9</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_name>application_explorer_new</sys_name>
        <sys_package display_value="Table configuration" source="9c555b512f941110916d50492799b6fa">9c555b512f941110916d50492799b6fa</sys_package>
        <sys_policy/>
        <sys_scope display_value="Table configuration">9c555b512f941110916d50492799b6fa</sys_scope>
        <sys_update_name>sys_ui_page_388fd4902f191110916d50492799b6d9</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2022-08-09 18:40:39</sys_updated_on>
    </sys_ui_page>
</record_update>
